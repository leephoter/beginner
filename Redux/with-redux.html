<!DOCTYPE html>
<html>
    <head>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/redux/4.0.0-beta.1/redux.min.js"></script>
    </head>
    <body>
        <style>
            .container {
                border: 5px solid black;
                padding: 10px;
            }
        </style>
        <div id="red"></div>
        <div id="blue"></div>
        <div id="green"></div>
        <script>
            function reducer(state, action) {
                //reducer: dispatch에 의해 action이 들어오면 action값과 기존 state값을 참조하여 새로운 state값을 저장(생성)
                console.log(state, action);
                if (state === undefined) {
                    //최초 초기화 단계 (초기값 선언)
                    return { color: "yellow" }; //초기 state값
                }
                if (action.type === "CHANGE_COLOR") {
                    newState = Object.assign({}, state, {
                        color: action.color,
                    });
                    //기존 값 복사 ->> color값 변경
                }
                return newState;
            }
            // Redux.createStore(reducer); //Redux라는 객체, createStore라는 API사용
            var store = Redux.createStore(
                reducer,
                window.__REDUX_DEVTOOLS_EXTENSION__ &&
                    window.__REDUX_DEVTOOLS_EXTENSION__()
            ); //Redux라는 객체, createStore라는 API사용
            //store라는 전역변수에 저장 ->> 어디서든 실행 가능
            console.log(store.getState());

            function red() {
                var state = store.getState();
                document.querySelector("#red").innerHTML = `
                          <div class="container" id="component_red" style="background-color:${state.color}">
                              <h1>red</h1>
                              <input type="button" value="fire" onclick="
                                  store.dispatch({type:'CHANGE_COLOR', color:'red'});
                                  // type값 필수
                              ">
                              </div>
                              `;
            }
            store.subscribe(red);
            red();
            function blue() {
                var state = store.getState();
                document.querySelector("#blue").innerHTML = `
                          <div class="container" id="component_blue" style="background-color:${state.color}">
                              <h1>blue</h1>
                              <input type="button" value="fire" onclick="
                                  store.dispatch({type:'CHANGE_COLOR', color:'skyblue'});
                                  // type값 필수
                              ">
                              </div>
                              `;
            }
            store.subscribe(blue);
            blue();
            function green() {
                var state = store.getState();
                document.querySelector("#green").innerHTML = `
                          <div class="container" id="component_green" style="background-color:${state.color}">
                              <h1>green</h1>
                              <input type="button" value="fire" onclick="
                                  store.dispatch({type:'CHANGE_COLOR', color:'green'});
                                  // type값 필수
                              ">
                              </div>
                              `;
            }
            store.subscribe(green);
            green();
        </script>
    </body>
</html>
